<!doctype html>
<html>
 <head>
  <meta charset="UTF-8">
  <title>用户信息</title>
  <link rel="stylesheet" href="../css/userlist.css" />
  <link rel="stylesheet" href="../css/bootstrap.css" />
  <script type="text/javascript" src="../js/jquery.min.js"></script>
  <script type="text/javascript" src="../js/popper.min.js"></script>
  <script type="text/javascript" src="../js/bootstrap.min.js"></script>
  <script src="../js/index.js"></script>
 </head>
 <body onload="list_user()">
	<div class="form-inline mt-5">
		<div class="col-lg-3 col-sm-12 p-0 text-right">
			<a href="javascript:skipindex()">
				<img src="../image/logo.png" alt="" id="p"/>
			</a>
		</div>
		<div class="col-lg-5 col-sm-12">
			<ul class="breadcrumb m-0 p-0 mt-5">
				<li class="breadcrumb-item top_a">
					<a href="javascript:skiplogin()">
						用户登录
						<div id="login_bg"></div>
					</a>
				</li>
				<li class="breadcrumb-item top_a">
					<a href="userreg.html">
						用户注册
						<div id="reg_bg"></div>
					</a>
				</li>
				<li class="breadcrumb-item top_a">
					<a href="">
						我的购物车
						<div id="shop_bg"></div>
					</a>
				</li>
				<li class="breadcrumb-item top_a">
					<a href="">
						我的收藏
						<div id="care_bg"></div>
					</a>
				</li>
				<li class="breadcrumb-item top_a">
					<a href="">
						用户中心
						<div id="user_bg"></div>
					</a>
				</li>
			</ul>
		</div>
		<div class="col-lg-4 col-sm-12 mt-4 p-0">
			<input class="inu1" type="text" placeholder="请输入您要搜索的内容"/>
		</div>
	</div>
	<hr class="mt-5" size="50px">
	<div class="container">
    	<ul id="bread" class="breadcrumb mt-5">
      		<li class="breadcrumb-item">
        		<a href="">首页</a>
      		</li>
      		<li class="breadcrumb-item">
        		<a href="">用户中心</a>
      		</li>
		</ul>
		<div class="row m-0">
			<div class="col-3 p-0">
				<div class="card">
					<div class="card-header p-2 bg-transparent"> 
						<a href="#indent" data-toggle="collapse" class="card-link text-muted">我的订单<span class="ml-5">>></span></a>
					</div>
					<div id="indent" class="collapse">
					<div class="card-body p-2 text-center">
						<ul class="list-unstyled">
							<li>
								<a href="" class="text-muted">全部订单</a>
							</li>
							<li class="mt-2">
								<a href="">待付款</a>
							</li>
							<li class="mt-2">
								<a href="">待收货</a>
							</li>
							<li class="mt-2">
								<a href="">待评价</a>
							</li>
							<li class="mt-2">
								<a href="">退货退款</a>
							</li>
						</ul>
					</div>
				</div>
				<div class="card-header p-2 bg-transparent"> 
						<a href="#site" data-toggle="collapse" class="card-link text-muted">地址信息<span class="ml-5">>></span></a>
				</div>
				<div id="site" class="collapse">
					<div class="card-body p-2 text-center">
						<ul class="list-unstyled">
							<li>
								<a href="javascript:skip_site()" class="text-muted">添加收货地址</a>
							</li>
						</ul>
					</div>
				</div>
				<div class="card-header p-2 bg-transparent"> 
						<a href="#user_list" data-toggle="collapse" class="card-link text-muted">账号管理<span class="ml-5">>></span></a>
				</div>
				<div id="user_list" class="collapse">
					<div class="card-body p-2 text-center">
						<ul class="list-unstyled">
							<li>
								<a href="" class="text-muted">我的信息</a>
							</li>
							<li>
								<a href="javascript:u_updatepwd()">密码修改</a>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<div class="col-9">
			<div class="list_header p-2 px-5"><span style="color:#808080">我的信息</span></div>
			<div class="user_list p-5">
				<div>
					<span class="userlist">用户名</span>：<input id="uname" type="text">
				</div>
				<hr>
				<div>
					<span class="userlist">电话</span>：<input id="phone" type="text">
				</div>
				<hr>
				<div>
					<span class="userlist">邮箱</span>：<input id="email" type="">
				</div>
				<hr>
				<div class="align-middle">
					<span class="userlist">性别</span>：<input class="input_mt" id="m" value="1" type="radio" name="gender"><label for="m"><span class="sex">男</span></label>
					<input class="input_mt" value="0" id="f" type="radio" name="gender"><label for="f"><span class="sex">女</span></label>
				</div>
				<hr>
				<div>
					<button class="btn btn-primary ml-5" onclick="user_update()">保存修改</button>
				</div>	
			</div>
		</div>
	</div>
</div>
	<hr class="end_hr">
	<div class="container">
	<div id="last">
		<img src="../image/logo.png" alt="" />
		<b>官方合作商城</b>
	</div>
	<div id="sym" class="d-flex justify-content-around text-center">
		<div>
			<a href="">
				<img src="../image/jd.jpeg" alt="" />
				<p>京东商城</p>
			</a>
		</div>
		<div>
			<a href="">
				<img src="../image/sn.jpeg" alt="" />
				<p>苏宁易购</p>
			</a>
		</div>
		<div>
			<a href="">
				<img src="../image/tb.jpeg" alt="" />
				<p>淘宝商城</p>
			</a>
		</div>
		<div>
			<a href="">
				<img src="../image/pss.png" alt="" />
				<p>拼少少</p>
			</a>
		</div>
	</div>
	</div>
	<div class="footer_first d-flex justify-content-around mt-5">
			<p class="h4 font-weight-bold">品类齐全，轻松购物</p>
			<p class="h4 font-weight-bold">多仓直发，极速配送</p>
			<p class="h4 font-weight-bold">正品行货，精致服务</p>
			<p class="h4 font-weight-bold">天天低价，畅选无忧</p>
		</div>
		<hr>
		<div class="container">
			<div class="row m-0" id="end_list">
			<div class="col-2">
				<ul class="list-unstyled">
					<li>
						购物指南
					</li>
					<li>
						<a href="">购物流程</a>
					</li>
					<li>
						<a href="">会员介绍</a>
					</li>
					<li>
						<a href="">生活旅行</a>
					</li>
					<li>
						<a href="">常见问题</a>
					</li>
					<li>
						<a href="">大家电</a>
						</li>
					<li>
						<a href="">联系客服</a>
					</li>
				</ul>
			</div>
			<div class="col-2">
				<ul class="list-unstyled">
					<li>配送方式
					</li>
					<li>
						<a href="">上门自提</a>
					</li>
					<li>
						<a href="">211限时达</a>
					</li>
					<li>
						<a href="">配送服务查询</a>
					</li>
					<li>
						<a href="">配送费收取标准</a>
					</li>
					<li>
						<a href="">海外配送</a>
					</li>
				</ul>
			</div>
			<div class="col-2">
				<ul class="list-unstyled">
					<li>
						支付方式
					</li>
					<li>
						<a href="">货到付款</a>
					</li>
					<li>
						<a href="">在线支付</a>
					</li>
					<li>
						<a href="">分期付款</a>
					</li>
					<li>
						<a href="">邮局汇款</a>
					</li>
					<li>
						<a href="">公司转账</a>
					</li>
				</ul>
			</div>
			<div class="col-2">
				<ul class="list-unstyled">
					<li>
						售后服务
					</li>
					<li>
						<a href="">价格保护</a>
					</li>
					<li>
						<a href="">退款说明</a>
					</li>
					<li>
						<a href="">返修/退款货</a>
					</li>
					<li>
						<a href="">取消订单</a>
					</li>
					<li>
						<a href="">售后政策</a>
					</li>
				</ul>
			</div>
			<div class="col-2">
				<ul class="list-unstyled">
					<li>
						特色服务
					</li>
					<li>
						<a href="">DIY装机</a>
					</li>
					<li>
						<a href="">延保服务</a>
					</li>
					<li>
						<a href="">超市E卡</a>
					</li>
					<li>
						<a href="">超市通信</a>
					</li>
					<li>
						<a href="">夺宝岛</a>
					</li>
					<li>
						<a href="">大超市智能</a>
					</li>
				</ul>
			</div>
			<div class="col-2">
				<p style="color:#808080;">大超市自营覆盖区</p>
				<p style="color:#808080;font-size:0.75rem">大超市以向全国2661个区县提供自营配送服务，支持货到付款，POS机刷卡和售后上门服务</p>
			</div>
		</div>
		<hr>
		<ul class="breadcrumb mb-0" id="end_bread">
			<li class="breadcrumb-item"><a href="">关于我们</a></li>
			<li class="breadcrumb-item"><a href="">联系我们</a></li>
			<li class="breadcrumb-item"><a href="">联系客服</a></li>
			<li class="breadcrumb-item"><a href="">合作招商</a></li>
			<li class="breadcrumb-item"><a href="">商家帮助</a></li>
			<li class="breadcrumb-item"><a href="">营销中心</a></li>
			<li class="breadcrumb-item"><a href="">手机超市</a></li>
			<li class="breadcrumb-item"><a href="">友情链接</a></li>
			<li class="breadcrumb-item"><a href="">销售联盟</a></li>
			<li class="breadcrumb-item"><a href="">超市社区</a></li>
			<li class="breadcrumb-item"><a href="">超市公益</a></li>
			<li class="breadcrumb-item"><a href="">English Site</a></li>
			<li class="breadcrumb-item"><a href="">Media</a></li>
		</ul>
			<ul class="breadcrumb justify-content-center text-muted mb-0 pb-0">
				<li class="breadcrumb-item h6">川公网备字199410051619号</li>
				<li class="breadcrumb-item h6">川ICP证1994号</li>
				<li class="breadcrumb-item h6">大超市零售第1994号</li>
			</ul>
		<ul class="breadcrumb text-muted justify-content-center p-0 m-0">
			<li class="breadcrumb-item">互联网出版许可证1994号</li>
			<li class="breadcrumb-item">网络文化许可证</li>
			<li class="breadcrumb-item">违法和不良举报电话：4006561155</li>
		</ul>
		<p class="text-muted text-center mb-0">Copyright&nbsp; © &nbsp;1994&nbsp;-&nbsp;2019 &nbsp;大超市abigmarket&nbsp;版权所有&nbsp;</p>
		<ul class="breadcrumb justify-content-center text-muted m-0 p-0 mb-5">
			<li>大超市旗下网站：</li>
			<li class="breadcrumb-item">超市钱包</li>
			<li class="breadcrumb-item">超市云</li>
			<li class="breadcrumb-item">超市借贷</li>
		</ul>
	</div>
	<script type="text/javascript">
		function list_user(){
			//获取前一个网页？后面的参数
			var url=new URLSearchParams(location.search);
			//获取参数中uid
			var uid=url.get("uid");
			if(uid==null){
				alert("请小可爱先登录哟");
				skipurl();
			}
			//创建xhr异步对象
			var xhr=new XMLHttpRequest();
			//绑定监听，获取响应数据
			xhr.onreadystatechange=function(){
				if(xhr.readyState==4&&xhr.status==200){
					var result=xhr.responseText;
					console.log(result)
					//json解析
					var arr=JSON.parse(result);
					console.log(arr[0]);
					uname.value=arr[0].uname;
					phone.value=arr[0].phone;
					email.value=arr[0].email;
					if(arr[0].gender==1){
						m.checked=true;
					}else{
						f.checked=true;
					}
				};
			};
			//创建请求
			xhr.open("get","/mypro/v5/userlist/"+uid,true);
			//发送请求
			xhr.send();
		};


		//用户点击用户中心没有登录跳转登录页面
		function skipurl(){
			location.href="userlogin.html";
		};

		//用户点击保存修改按钮，触发事件修改数据库信息
		function user_update(){
			//获取前一个网页？后面的参数
			var url=new URLSearchParams(location.search);
			//获取参数中uid
			var uid=url.get("uid");
			//创建xhr异步对象
			var xhr=new XMLHttpRequest();
			//绑定监听，获取响应数据
			xhr.onreadystatechange=function(){
				if(xhr.readyState==4&&xhr.status==200){
					var result=xhr.responseText;
					if(result==1){
						alert("修改成功");
						list_user();
					}else{
						alert("修改失败");
					}
				};
			};
			//转换性别为1/0
			var gender="";
			if(m.checked){
				gender=1;
			}else if(f.checked){
				gender=0;
			}
			//创建请求
			xhr.open("put","/mypro/v5/userUpdate",true);
			//修改请求头信息
			xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
			//创建formdata
			var formdata="uid="+uid+"&uname="+uname.value+"&phone="+phone.value+"&email="+email.value+"&gender="+gender;
			//发送请求
			console.log(formdata);
			xhr.send(formdata);
		};


		//用户点击修改密码页面，传递uid参数
		function u_updatepwd(){
			//获取前一个网页？后面的参数
			var url=new URLSearchParams(location.search);
			//获取参数中uid
			var uid=url.get("uid");
			location.href="u_updatepwd.html?uid="+uid;
		}
		// //用户中心跳转首页传递uid参数
		// function skipindex(){
		// 	//获取前一个网页？后面的参数
		// 	var url=new URLSearchParams(location.search);
		// 	//获取参数中uid
		// 	var uid=url.get("uid");
		// 	location.href="index.html?uid="+uid;
		// }
	</script>
 </body>
</html>
